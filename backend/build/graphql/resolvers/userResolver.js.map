{"version":3,"sources":["../../../src/graphql/resolvers/userResolver.js"],"names":["Query","user","parent","args","ctx","info","id","AuthenticationError","numId","Number","prisma","findUnique","where","userRecord","clientUserData","console","log","users","findMany","userRecords","clientUsersData","map","currentUser","port","deployedUrl","accessToken","payload","userId","cookieOptions","res","cookie","Mutation","signUp","email","password","UserInputError","input","emailNormalized","trim","toLowerCase","passwordNormalized","foundUser","bcrypt","hash","saltRounds","passwordHashed","create","data","newUserRecord","logIn","logOut","expires","maxAge","clearCookie"],"mappings":"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","sourcesContent":["import { AuthenticationError, UserInputError } from 'apollo-server-express';\r\nimport bcrypt from 'bcryptjs';\r\n\r\nimport { createAccessToken, verifyAccessToken } from '../../utils/accessToken';\r\nimport userClientCleaner from '../../utils/userClientCleaner';\r\nimport {\r\n  isEmailWellFormed,\r\n  isPasswordWellFormed,\r\n  validatePassword\r\n} from '../../utils/validation';\r\nimport { cookieOptions, saltRounds, port, deployedUrl } from '../../config';\r\n\r\nexport default {\r\n  Query: {\r\n    // Return user matching id\r\n    user: async (parent, args, ctx, info) => {\r\n      const { id } = args;\r\n\r\n      // Check if missing args\r\n      if (!id) throw new AuthenticationError('error.missingArgument');\r\n\r\n      // Convert string to number\r\n      const numId = Number(id);\r\n\r\n      // Type check\r\n      if (typeof numId !== 'number')\r\n        throw new AuthenticationError('error.invalidArgument');\r\n\r\n      try {\r\n        // Find user matching userId\r\n        const userRecord = await ctx.prisma.user.findUnique({\r\n          where: { id: numId }\r\n        });\r\n\r\n        // Clean user data for client\r\n        const clientUserData = userClientCleaner(userRecord);\r\n\r\n        // Return user data\r\n        return clientUserData;\r\n      } catch (error) {\r\n        console.log('user.user error: ', error);\r\n\r\n        return {};\r\n      }\r\n    },\r\n\r\n    // Return all users\r\n    users: async (parent, args, ctx, info) => {\r\n      try {\r\n        // Find all users\r\n        const userRecords = await ctx.prisma.user.findMany();\r\n\r\n        // Clean users data for client\r\n        const clientUsersData = userRecords.map(user =>\r\n          userClientCleaner(user)\r\n        );\r\n\r\n        // Return users data\r\n        return clientUsersData;\r\n      } catch (error) {\r\n        console.log('user.users error: ', error);\r\n\r\n        return {};\r\n      }\r\n    },\r\n\r\n    // Return authenticated user\r\n    currentUser: async (parent, args, ctx, info) => {\r\n      console.log('port- ', port);\r\n      console.log('deployedUrl- ', deployedUrl);\r\n\r\n      // If no access token, return error\r\n      if (!ctx.accessToken)\r\n        return new AuthenticationError('user.invalidCredentials');\r\n\r\n      console.log('ctx.accessToken:', ctx.accessToken);\r\n\r\n      // Verify access token and decode payload\r\n      const payload = verifyAccessToken(ctx.accessToken);\r\n\r\n      console.log('payload:', payload);\r\n\r\n      try {\r\n        // Find user matching userId\r\n        const userRecord = await ctx.prisma.user.findUnique({\r\n          where: { id: payload.userId }\r\n        });\r\n\r\n        console.log('userRecord:', userRecord);\r\n\r\n        // If no user found, return error\r\n        if (!userRecord) return AuthenticationError('user.notFound');\r\n\r\n        // Create new access token\r\n        const accessToken = createAccessToken(userRecord.id);\r\n\r\n        console.log('accessToken:', accessToken);\r\n\r\n        console.log('cookieOptions:', cookieOptions);\r\n\r\n        // Send back new access token\r\n        ctx.res.cookie('at', accessToken, cookieOptions);\r\n\r\n        // Clean user data for client\r\n        const clientUserData = userClientCleaner(userRecord);\r\n\r\n        console.log('clientUserData:', clientUserData);\r\n\r\n        // Return user data\r\n        return clientUserData;\r\n      } catch (error) {\r\n        console.log('user.currentUser error: ', error);\r\n\r\n        return {};\r\n      }\r\n    }\r\n  },\r\n\r\n  Mutation: {\r\n    signUp: async (parent, args, ctx, info) => {\r\n      const { email, password } = args;\r\n      console.log('email:', email);\r\n      console.log('password:', password);\r\n\r\n      // Check if missing args\r\n      if (!(email || password))\r\n        throw new UserInputError('error.missingArgument');\r\n\r\n      // Type check\r\n      for (const input of [email, password])\r\n        if (typeof input !== 'string')\r\n          throw new UserInputError('error.invalidArgument');\r\n\r\n      // Normalize email\r\n      const emailNormalized = email.trim().toLowerCase();\r\n\r\n      console.log('emailNormalized:', emailNormalized);\r\n\r\n      // Normalize password\r\n      const passwordNormalized = email.trim();\r\n\r\n      console.log('passwordNormalized:', passwordNormalized);\r\n\r\n      // Check if email is well-formed\r\n      isEmailWellFormed(emailNormalized);\r\n\r\n      // Check if password is well-formed\r\n      isPasswordWellFormed(passwordNormalized);\r\n\r\n      // Find user matching email\r\n      const foundUser = await ctx.prisma.user.findUnique({\r\n        where: { email: emailNormalized }\r\n      });\r\n\r\n      console.log('foundUser:', foundUser);\r\n\r\n      // If user found, return error\r\n      if (foundUser) throw new UserInputError('email.invalid');\r\n\r\n      // Encrypt password\r\n      const passwordHashed = await bcrypt.hash(passwordNormalized, saltRounds);\r\n\r\n      console.log('passwordHashed:', passwordHashed);\r\n\r\n      try {\r\n        // Create user\r\n        const newUserRecord = await ctx.prisma.user.create({\r\n          data: { email: emailNormalized, password: passwordHashed }\r\n        });\r\n\r\n        console.log('newUserRecord:', newUserRecord);\r\n\r\n        // Create access token\r\n        const accessToken = createAccessToken(newUserRecord.id);\r\n\r\n        console.log('accessToken:', accessToken);\r\n\r\n        // Send back new access token\r\n        ctx.res.cookie('at', accessToken, cookieOptions);\r\n\r\n        console.log('cookieOptions:', cookieOptions);\r\n\r\n        // Clean user data for client\r\n        const clientUserData = userClientCleaner(newUserRecord);\r\n\r\n        console.log('clientUserData:', clientUserData);\r\n\r\n        // Return user data\r\n        return clientUserData;\r\n      } catch (error) {\r\n        console.log('user.signUp error: ', error);\r\n\r\n        return {};\r\n      }\r\n    },\r\n\r\n    logIn: async (parent, args, ctx, info) => {\r\n      const { email, password } = args;\r\n\r\n      console.log('email:', email);\r\n      console.log('password:', password);\r\n\r\n      // Check if missing args\r\n      if (!email || !password)\r\n        throw new AuthenticationError('login.missingCredentials');\r\n\r\n      // Type check\r\n      for (const input of [email, password])\r\n        if (typeof input !== 'string')\r\n          throw new UserInputError('error.invalidArgument');\r\n\r\n      // Normalize email\r\n      const emailNormalized = email.trim().toLowerCase();\r\n\r\n      console.log('emailNormalized:', emailNormalized);\r\n\r\n      // Normalize password\r\n      const passwordNormalized = email.trim();\r\n\r\n      console.log('passwordNormalized:', passwordNormalized);\r\n\r\n      // Check if email is well-formed\r\n      isEmailWellFormed(emailNormalized);\r\n\r\n      // Check if password is well-formed\r\n      isPasswordWellFormed(passwordNormalized);\r\n\r\n      try {\r\n        // Find user matching email\r\n        const userRecord = await ctx.prisma.user.findUnique({\r\n          where: { email }\r\n        });\r\n\r\n        console.log('userRecord:', userRecord);\r\n\r\n        // If user not found, return error\r\n        if (!userRecord)\r\n          throw new AuthenticationError('login.invalidCredentials');\r\n\r\n        // Check if password input matches users password\r\n        validatePassword(password, userRecord.password);\r\n\r\n        // Create access token\r\n        const accessToken = createAccessToken(userRecord.id);\r\n\r\n        console.log('accessToken:', accessToken);\r\n\r\n        console.log('cookieOptions:', cookieOptions);\r\n\r\n        // Send back new access token\r\n        ctx.res.cookie('at', accessToken, cookieOptions);\r\n\r\n        // Clean user data for client\r\n        const clientUserData = userClientCleaner(userRecord);\r\n\r\n        console.log('clientUserData:', clientUserData);\r\n\r\n        // Return user data\r\n        return { user: clientUserData };\r\n      } catch (error) {\r\n        console.log('user.logIn error: ', error);\r\n\r\n        return {};\r\n      }\r\n    },\r\n\r\n    logOut: (parent, args, ctx, info) => {\r\n      // const cookie = serialize('at', '', {\r\n      //   maxAge: -1,\r\n      //   path: '/'\r\n      // });\r\n      // ctx.res.setHeader('Set-Cookie', cookie);\r\n\r\n      delete cookieOptions.expires;\r\n      delete cookieOptions.maxAge;\r\n\r\n      ctx.res.clearCookie('at', cookieOptions);\r\n\r\n      return true;\r\n    }\r\n  }\r\n};\r\n"],"file":"userResolver.js"}